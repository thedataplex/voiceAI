window.fun_contactnum = function fun_contactnum()
{
	fun_speak(speak_contnum_header);
	output_contnum.innerHTML = speak_contnum_header;

	navigator.mediaDevices.getUserMedia({ audio: true })
	.then(stream => {
         
		// Initialize the media recorder object
		audioRecorder_contnum = new MediaRecorder(stream);
            
		// ContactNumberDataAvailable event is fired when the recording is stopped
		audioRecorder_contnum.addEventListener('dataavailable', e => {
			audioChunks_contnum.push(e.data);
		});
            
		// start recording when the start button is clicked
		startButton_contnum.addEventListener('click', () => {
			//fun_speak(speak_contnum_header);
			audioChunks_contnum = [];
			audioRecorder_contnum.start();
			output_contnum.innerHTML = "Recording started for Patient's Phone Number! Speak now. When you are done, Press Stop Button";
		});


		// stop recording when the stop button is clicked
		stopButton_contnum.addEventListener('click', () => {
			audioRecorder_contnum.stop();
			output_contnum.innerHTML = "Recording stopped for Patient's Phone Number! Click on the Next button to switch to next field Play button to play the recorded audio.";
			fun_speak(output_contnum.innerHTML);
		});
            
		// play the recorded audio when the play button is clicked
		playButton_contnum.addEventListener('click', () => {
			//output_contnum.innerHTML = "Playing the recorded audio for Patient's Phone Number!";
			//audioRecorder_contnum.stop();
			fun_stop_recording_all();
			const blobObj = new Blob(audioChunks_contnum, { type: 'audio/webm' });
			const audioUrl = URL.createObjectURL(blobObj);
			const audio = new Audio(audioUrl);
			fun_speak(speak_contnum_footer);
			audio.play();
		});
	}).catch(err => {
		// If the user denies permission to record audio, then display an error.
		console.log('Error: ' + err);
	});
}
